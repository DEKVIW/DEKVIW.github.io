<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>八字综合分析Prompt生成器</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 20px;
            padding: 0;
            background-color: #f4f4f4;
        }

        h1 {
            text-align: center;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }

        input[type="number"],
        input[type="time"],
        select,
        input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .date-group {
            display: flex;
            gap: 10px;
        }

        .date-group input {
            width: 33%;
        }

        .radio-group {
            display: flex;
            gap: 20px;
        }

        .radio-group label {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }

        input[type="radio"] {
            margin: 0;
        }

        #generate-btn {
            width: 100%;
            padding: 12px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 18px;
        }

        #generate-btn:hover {
            background-color: #0056b3;
        }

        #error-message {
            color: red;
            margin-top: 10px;
            display: none;
        }

        pre {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 4px;
            white-space: pre-wrap;
            position: relative;
        }

        .form-section {
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
        }

        .form-section:last-child {
            border-bottom: none;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 5px 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .copy-btn:hover {
            background-color: #0056b3;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>八字综合分析Prompt生成器</h1>

        <div class="form-section">
            <label>出生日期 (公历):</label>
            <div class="date-group">
                <input type="number" id="birth-year" placeholder="年 (YYYY)" required>
                <input type="number" id="birth-month" placeholder="月 (MM)" min="1" max="12" required>
                <input type="number" id="birth-day" placeholder="日 (DD)" min="1" max="31" required>
            </div>

            <label for="birth-time">出生时间:</label>
            <input type="time" id="birth-time" required>
        </div>

        <div class="form-section">
            <label>性别:</label>
            <div class="radio-group">
                <label><input type="radio" name="gender" value="男" required> 男</label>
                <label><input type="radio" name="gender" value="女" required> 女</label>
            </div>
        </div>

        <div class="form-section">
            <label for="province">出生省份:</label>
            <select id="province" required>
                <option value="">-- 请选择 --</option>
            </select>

            <label for="city">出生城市:</label>
            <select id="city" required>
                <option value="">-- 请选择 --</option>
            </select>

            <label for="district">出生区/县 (选填):</label>
            <input type="text" id="district">
        </div>

        <button id="generate-btn">生成分析 Prompt</button>
        <div id="error-message"></div>
        <h2>结果:</h2>
        <pre id="output">
            <button class="copy-btn" onclick="copyPrompt()">复制</button>
        </pre>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const birthYearInput = document.getElementById('birth-year');
            const birthMonthInput = document.getElementById('birth-month');
            const birthDayInput = document.getElementById('birth-day');
            const birthTimeInput = document.getElementById('birth-time');
            const genderRadios = document.getElementsByName('gender');
            const provinceSelect = document.getElementById('province');
            const citySelect = document.getElementById('city');
            const districtInput = document.getElementById('district');
            const generateBtn = document.getElementById('generate-btn');
            const errorMessage = document.getElementById('error-message');
            const outputDiv = document.getElementById('output');

            const locationData = {
                "北京市": { "北京市": { longitude: 116.4 } },
                "天津市": { "天津市": { longitude: 117.2 } },
                "河北省": {
                    "石家庄市": { longitude: 114.5 },
                    "唐山市": { longitude: 118.2 },
                    "秦皇岛市": { longitude: 119.6 },
                    "邯郸市": { longitude: 114.5 },
                    "邢台市": { longitude: 114.5 },
                    "保定市": { longitude: 115.5 },
                    "张家口市": { longitude: 114.9 },
                    "承德市": { longitude: 117.9 },
                    "沧州市": { longitude: 116.8 },
                    "廊坊市": { longitude: 116.7 },
                    "衡水市": { longitude: 115.7 }
                },
                "山西省": {
                    "太原市": { longitude: 112.5 },
                    "大同市": { longitude: 113.3 },
                    "阳泉市": { longitude: 113.6 },
                    "长治市": { longitude: 113.1 },
                    "晋城市": { longitude: 112.8 },
                    "朔州市": { longitude: 112.4 },
                    "晋中市": { longitude: 112.7 },
                    "运城市": { longitude: 111.0 },
                    "忻州市": { longitude: 112.7 },
                    "临汾市": { longitude: 111.5 },
                    "吕梁市": { longitude: 111.1 }
                },
                "内蒙古自治区": {
                    "呼和浩特市": { longitude: 111.7 },
                    "包头市": { longitude: 110.0 },
                    "乌海市": { longitude: 118.3 },
                    "赤峰市": { longitude: 118.9 },
                    "通辽市": { longitude: 122.2 },
                    "鄂尔多斯市": { longitude: 109.8 },
                    "呼伦贝尔市": { longitude: 119.7 },
                    "巴彦淖尔市": { longitude: 107.4 },
                    "乌兰察布市": { longitude: 113.2 },
                    "兴安盟": { longitude: 122.1 },
                    "锡林郭勒盟": { longitude: 116.0 },
                    "阿拉善盟": { longitude: 105.7 }
                },
                "辽宁省": {
                    "沈阳市": { longitude: 123.4 },
                    "大连市": { longitude: 121.6 },
                    "鞍山市": { longitude: 122.9 },
                    "抚顺市": { longitude: 123.9 },
                    "本溪市": { longitude: 123.7 },
                    "丹东市": { longitude: 124.3 },
                    "锦州市": { longitude: 121.1 },
                    "营口市": { longitude: 122.2 },
                    "阜新市": { longitude: 121.6 },
                    "辽阳市": { longitude: 123.2 },
                    "盘锦市": { longitude: 122.0 },
                    "铁岭市": { longitude: 123.8 },
                    "朝阳市": { longitude: 120.4 },
                    "葫芦岛市": { longitude: 120.8 }
                },
                "吉林省": {
                    "长春市": { longitude: 125.3 },
                    "吉林市": { longitude: 126.5 },
                    "四平市": { longitude: 124.3 },
                    "辽源市": { longitude: 125.1 },
                    "通化市": { longitude: 125.9 },
                    "白山市": { longitude: 126.4 },
                    "松原市": { longitude: 124.8 },
                    "白城市": { longitude: 122.8 },
                    "延边朝鲜族自治州": { longitude: 129.5 }
                },
                "黑龙江省": {
                    "哈尔滨市": { longitude: 126.6 },
                    "齐齐哈尔市": { longitude: 123.9 },
                    "鸡西市": { longitude: 130.9 },
                    "鹤岗市": { longitude: 130.3 },
                    "双鸭山市": { longitude: 131.1 },
                    "大庆市": { longitude: 125.1 },
                    "伊春市": { longitude: 129.0 },
                    "佳木斯市": { longitude: 130.3 },
                    "七台河市": { longitude: 130.9 },
                    "牡丹江市": { longitude: 129.6 },
                    "黑河市": { longitude: 127.5 },
                    "绥化市": { longitude: 126.9 },
                    "大兴安岭地区": { longitude: 124.7 }
                },
                "上海市": { "上海市": { longitude: 121.4 } },
                "江苏省": {
                    "南京市": { longitude: 118.8 },
                    "无锡市": { longitude: 120.3 },
                    "徐州市": { longitude: 117.2 },
                    "常州市": { longitude: 119.9 },
                    "苏州市": { longitude: 120.6 },
                    "南通市": { longitude: 120.8 },
                    "连云港市": { longitude: 119.2 },
                    "淮安市": { longitude: 119.0 },
                    "盐城市": { longitude: 120.1 },
                    "扬州市": { longitude: 119.4 },
                    "镇江市": { longitude: 119.4 },
                    "泰州市": { longitude: 119.9 },
                    "宿迁市": { longitude: 118.3 }
                },
                "浙江省": {
                    "杭州市": { longitude: 120.2 },
                    "宁波市": { longitude: 121.5 },
                    "温州市": { longitude: 120.6 },
                    "嘉兴市": { longitude: 120.7 },
                    "湖州市": { longitude: 120.1 },
                    "绍兴市": { longitude: 120.5 },
                    "金华市": { longitude: 119.6 },
                    "衢州市": { longitude: 118.8 },
                    "舟山市": { longitude: 122.3 },
                    "台州市": { longitude: 121.4 },
                    "丽水市": { longitude: 119.9 }
                },
                "安徽省": {
                    "合肥市": { longitude: 117.3 },
                    "芜湖市": { longitude: 118.3 },
                    "蚌埠市": { longitude: 117.3 },
                    "淮南市": { longitude: 116.7 },
                    "马鞍山市": { longitude: 118.5 },
                    "淮北市": { longitude: 116.8 },
                    "铜陵市": { longitude: 117.8 },
                    "安庆市": { longitude: 117.0 },
                    "黄山市": { longitude: 118.3 },
                    "滁州市": { longitude: 118.3 },
                    "阜阳市": { longitude: 115.8 },
                    "宿州市": { longitude: 116.9 },
                    "六安市": { longitude: 116.5 },
                    "亳州市": { longitude: 115.7 },
                    "池州市": { longitude: 117.4 },
                    "宣城市": { longitude: 118.7 }
                },
                "福建省": {
                    "福州市": { longitude: 119.3 },
                    "厦门市": { longitude: 118.1 },
                    "莆田市": { longitude: 119.0 },
                    "三明市": { longitude: 117.6 },
                    "泉州市": { longitude: 118.6 },
                    "漳州市": { longitude: 117.6 },
                    "南平市": { longitude: 118.0 },
                    "龙岩市": { longitude: 117.0 },
                    "宁德市": { longitude: 119.5 }
                },
                "江西省": {
                    "南昌市": { longitude: 115.9 },
                    "景德镇市": { longitude: 117.2 },
                    "萍乡市": { longitude: 113.8 },
                    "九江市": { longitude: 116.0 },
                    "新余市": { longitude: 114.9 },
                    "鹰潭市": { longitude: 117.0 },
                    "赣州市": { longitude: 114.9 },
                    "宜春市": { longitude: 114.4 },
                    "上饶市": { longitude: 117.9 },
                    "吉安市": { longitude: 114.9 },
                    "抚州市": { longitude: 116.3 }
                },
                "山东省": {
                    "济南市": { longitude: 117.0 },
                    "青岛市": { longitude: 120.3 },
                    "淄博市": { longitude: 118.0 },
                    "枣庄市": { longitude: 117.5 },
                    "东营市": { longitude: 118.5 },
                    "烟台市": { longitude: 121.4 },
                    "潍坊市": { longitude: 119.1 },
                    "济宁市": { longitude: 116.5 },
                    "泰安市": { longitude: 117.1 },
                    "威海市": { longitude: 122.1 },
                    "日照市": { longitude: 119.5 },
                    "滨州市": { longitude: 118.0 },
                    "德州市": { longitude: 116.3 },
                    "聊城市": { longitude: 115.9 },
                    "临沂市": { longitude: 118.3 },
                    "菏泽市": { longitude: 115.4 }
                },
                "河南省": {
                    "郑州市": { longitude: 113.6 },
                    "开封市": { longitude: 114.3 },
                    "洛阳市": { longitude: 112.4 },
                    "平顶山市": { longitude: 113.3 },
                    "安阳市": { longitude: 114.3 },
                    "鹤壁市": { longitude: 114.3 },
                    "新乡市": { longitude: 113.9 },
                    "焦作市": { longitude: 113.2 },
                    "濮阳市": { longitude: 115.0 },
                    "许昌市": { longitude: 113.8 },
                    "漯河市": { longitude: 114.0 },
                    "三门峡市": { longitude: 111.9 },
                    "南阳市": { longitude: 112.5 },
                    "商丘市": { longitude: 115.6 },
                    "信阳市": { longitude: 114.0 },
                    "周口市": { longitude: 114.6 },
                    "驻马店市": { longitude: 114.0 },
                    "济源市": { longitude: 112.6 }
                },
                "湖北省": {
                    "武汉市": { longitude: 114.3 },
                    "黄石市": { longitude: 114.9 },
                    "十堰市": { longitude: 110.7 },
                    "宜昌市": { longitude: 111.3 },
                    "襄阳市": { longitude: 112.1 },
                    "鄂州市": { longitude: 114.8 },
                    "荆门市": { longitude: 112.2 },
                    "孝感市": { longitude: 113.9 },
                    "荆州市": { longitude: 112.2 },
                    "黄冈市": { longitude: 114.8 },
                    "咸宁市": { longitude: 114.3 },
                    "随州市": { longitude: 113.3 },
                    "恩施土家族苗族自治州": { longitude: 109.4 },
                    "仙桃市": { longitude: 113.4 },
                    "潜江市": { longitude: 112.9 },
                    "天门市": { longitude: 113.1 },
                    "神农架林区": { longitude: 110.3 }
                },
                "湖南省": {
                    "长沙市": { longitude: 113.0 },
                    "株洲市": { longitude: 113.1 },
                    "湘潭市": { longitude: 112.9 },
                    "衡阳市": { longitude: 112.6 },
                    "邵阳市": { longitude: 111.4 },
                    "岳阳市": { longitude: 113.1 },
                    "常德市": { longitude: 111.6 },
                    "张家界市": { longitude: 110.4 },
                    "益阳市": { longitude: 112.3 },
                    "郴州市": { longitude: 113.0 },
                    "永州市": { longitude: 111.6 },
                    "怀化市": { longitude: 110.0 },
                    "娄底市": { longitude: 112.0 },
                    "湘西土家族苗族自治州": { longitude: 109.7 }
                },
                "广东省": {
                    "广州市": { longitude: 113.2 },
                    "韶关市": { longitude: 113.6 },
                    "深圳市": { longitude: 114.0 },
                    "珠海市": { longitude: 113.5 },
                    "汕头市": { longitude: 116.6 },
                    "佛山市": { longitude: 113.1 },
                    "江门市": { longitude: 113.0 },
                    "湛江市": { longitude: 110.3 },
                    "茂名市": { longitude: 110.8 },
                    "肇庆市": { longitude: 112.4 },
                    "惠州市": { longitude: 114.4 },
                    "梅州市": { longitude: 116.1 },
                    "汕尾市": { longitude: 115.3 },
                    "河源市": { longitude: 114.6 },
                    "阳江市": { longitude: 111.9 },
                    "清远市": { longitude: 113.0 },
                    "东莞市": { longitude: 113.7 },
                    "中山市": { longitude: 113.3 },
                    "潮州市": { longitude: 116.6 },
                    "揭阳市": { longitude: 116.3 },
                    "云浮市": { longitude: 112.0 }
                },
                "广西壮族自治区": {
                    "南宁市": { longitude: 108.3 },
                    "柳州市": { longitude: 109.4 },
                    "桂林市": { longitude: 110.2 },
                    "梧州市": { longitude: 111.3 },
                    "北海市": { longitude: 109.1 },
                    "防城港市": { longitude: 108.3 },
                    "钦州市": { longitude: 108.6 },
                    "贵港市": { longitude: 109.5 },
                    "玉林市": { longitude: 110.1 },
                    "百色市": { longitude: 106.6 },
                    "贺州市": { longitude: 111.5 },
                    "河池市": { longitude: 107.9 },
                    "来宾市": { longitude: 109.2 },
                    "崇左市": { longitude: 107.3 }
                },
                "海南省": {
                    "海口市": { longitude: 110.3 },
                    "三亚市": { longitude: 109.5 },
                    "三沙市": { longitude: 112.3 },
                    "儋州市": { longitude: 109.5 },
                    "文昌市": { longitude: 110.7 },
                    "琼海市": { longitude: 110.4 },
                    "万宁市": { longitude: 110.4 },
                    "五指山市": { longitude: 109.5 },
                    "东方市": { longitude: 108.6 },
                    "定安县": { longitude: 110.3 },
                    "屯昌县": { longitude: 109.9 },
                    "澄迈县": { longitude: 110.0 },
                    "临高县": { longitude: 109.7 },
                    "白沙黎族自治县": { longitude: 109.4 },
                    "昌江黎族自治县": { longitude: 109.0 },
                    "乐东黎族自治县": { longitude: 109.1 },
                    "陵水黎族自治县": { longitude: 110.0 },
                    "保亭黎族苗族自治县": { longitude: 109.7 },
                    "琼中黎族苗族自治县": { longitude: 109.8 }
                },
                "重庆市": { "重庆市": { longitude: 106.5 } },
                "四川省": {
                    "成都市": { longitude: 104.0 },
                    "自贡市": { longitude: 104.7 },
                    "攀枝花市": { longitude: 101.7 },
                    "泸州市": { longitude: 105.4 },
                    "德阳市": { longitude: 104.3 },
                    "绵阳市": { longitude: 104.7 },
                    "广元市": { longitude: 105.8 },
                    "遂宁市": { longitude: 105.5 },
                    "内江市": { longitude: 105.0 },
                    "乐山市": { longitude: 103.7 },
                    "南充市": { longitude: 106.1 },
                    "眉山市": { longitude: 103.8 },
                    "宜宾市": { longitude: 104.5 },
                    "广安市": { longitude: 106.6 },
                    "达州市": { longitude: 107.5 },
                    "雅安市": { longitude: 103.0 },
                    "巴中市": { longitude: 106.7 },
                    "资阳市": { longitude: 104.9 },
                    "阿坝藏族羌族自治州": { longitude: 102.2 },
                    "甘孜藏族自治州": { longitude: 101.9 },
                    "凉山彝族自治州": { longitude: 102.2 }
                },
                "贵州省": {
                    "贵阳市": { longitude: 106.7 },
                    "六盘水市": { longitude: 104.8 },
                    "遵义市": { longitude: 106.9 },
                    "安顺市": { longitude: 105.9 },
                    "毕节市": { longitude: 105.2 },
                    "铜仁市": { longitude: 109.1 },
                    "黔东南苗族侗族自治州": { longitude: 107.9 },
                    "黔南布依族苗族自治州": { longitude: 107.5 },
                    "黔西南布依族苗族自治州": { longitude: 104.9 }
                },
                "云南省": {
                    "昆明市": { longitude: 102.7 },
                    "曲靖市": { longitude: 103.8 },
                    "玉溪市": { longitude: 102.5 },
                    "保山市": { longitude: 99.1 },
                    "昭通市": { longitude: 103.7 },
                    "丽江市": { longitude: 100.2 },
                    "普洱市": { longitude: 101.0 },
                    "临沧市": { longitude: 99.9 },
                    "楚雄彝族自治州": { longitude: 101.5 },
                    "红河哈尼族彝族自治州": { longitude: 103.4 },
                    "文山壮族苗族自治州": { longitude: 104.2 },
                    "西双版纳傣族自治州": { longitude: 100.8 },
                    "大理白族自治州": { longitude: 100.2 },
                    "德宏傣族景颇族自治州": { longitude: 98.6 },
                    "怒江傈僳族自治州": { longitude: 98.8 },
                    "迪庆藏族自治州": { longitude: 99.7 }
                },
                "西藏自治区": {
                    "拉萨市": { longitude: 91.1 },
                    "日喀则市": { longitude: 88.8 },
                    "昌都市": { longitude: 97.1 },
                    "林芝市": { longitude: 94.3 },
                    "山南市": { longitude: 91.7 },
                    "那曲市": { longitude: 92.0 },
                    "阿里地区": { longitude: 80.1 }
                },
                "陕西省": {
                    "西安市": { longitude: 108.9 },
                    "铜川市": { longitude: 109.1 },
                    "宝鸡市": { longitude: 107.1 },
                    "咸阳市": { longitude: 108.7 },
                    "渭南市": { longitude: 109.5 },
                    "延安市": { longitude: 109.4 },
                    "汉中市": { longitude: 107.0 },
                    "榆林市": { longitude: 109.7 },
                    "安康市": { longitude: 109.0 },
                    "商洛市": { longitude: 110.0 }
                },
                "甘肃省": {
                    "兰州市": { longitude: 103.7 },
                    "嘉峪关市": { longitude: 98.2 },
                    "金昌市": { longitude: 102.2 },
                    "白银市": { longitude: 104.1 },
                    "天水市": { longitude: 105.7 },
                    "武威市": { longitude: 102.6 },
                    "张掖市": { longitude: 100.4 },
                    "平凉市": { longitude: 106.6 },
                    "酒泉市": { longitude: 98.5 },
                    "庆阳市": { longitude: 107.6 },
                    "定西市": { longitude: 104.6 },
                    "陇南市": { longitude: 104.9 },
                    "临夏回族自治州": { longitude: 103.2 },
                    "甘南藏族自治州": { longitude: 102.9 }
                },
                "青海省": {
                    "西宁市": { longitude: 101.7 },
                    "海东市": { longitude: 102.1 },
                    "海北藏族自治州": { longitude: 100.9 },
                    "黄南藏族自治州": { longitude: 102.0 },
                    "海南藏族自治州": { longitude: 100.6 },
                    "果洛藏族自治州": { longitude: 100.2 },
                    "玉树藏族自治州": { longitude: 97.0 },
                    "海西蒙古族藏族自治州": { longitude: 97.0 }
                },
                "宁夏回族自治区": {
                    "银川市": { longitude: 106.2 },
                    "石嘴山市": { longitude: 106.3 },
                    "吴忠市": { longitude: 106.1 },
                    "固原市": { longitude: 106.2 },
                    "中卫市": { longitude: 105.1 }
                },
                "新疆维吾尔自治区": {
                    "乌鲁木齐市": { longitude: 87.6 },
                    "克拉玛依市": { longitude: 84.7 },
                    "吐鲁番市": { longitude: 89.2 },
                    "哈密市": { longitude: 93.5 },
                    "昌吉回族自治州": { longitude: 87.3 },
                    "博尔塔拉蒙古自治州": { longitude: 82.0 },
                    "巴音郭楞蒙古自治州": { longitude: 86.1 },
                    "阿克苏地区": { longitude: 80.3 },
                    "克孜勒苏柯尔克孜自治州": { longitude: 76.2 },
                    "喀什地区": { longitude: 75.9 },
                    "和田地区": { longitude: 79.9 },
                    "伊犁哈萨克自治州": { longitude: 81.3 },
                    "塔城地区": { longitude: 82.9 },
                    "阿勒泰地区": { longitude: 88.1 },
                    "石河子市": { longitude: 86.0 },
                    "阿拉尔市": { longitude: 81.2 },
                    "图木舒克市": { longitude: 79.0 },
                    "五家渠市": { longitude: 87.2 }
                },
                "香港特别行政区": { "香港": { longitude: 114.1 } },
                "澳门特别行政区": { "澳门": { longitude: 113.5 } },
                "台湾省": {
                    "台北市": { longitude: 121.5 },
                    "高雄市": { longitude: 120.3 }
                }
            };

            function populateProvinces() {
                for (const province in locationData) {
                    const option = document.createElement('option');
                    option.value = province;
                    option.textContent = province;
                    provinceSelect.appendChild(option);
                }
            }

            function populateCities(province) {
                citySelect.innerHTML = '<option value="">--请选择--</option>';
                if (locationData[province]) {
                    for (const city in locationData[province]) {
                        const option = document.createElement('option');
                        option.value = city;
                        option.textContent = city;
                        citySelect.appendChild(option);
                    }
                }
            }

            function validateForm() {
                errorMessage.style.display = 'none';
                errorMessage.textContent = '';
                let isValid = true;

                if (!birthYearInput.value) {
                    errorMessage.textContent += "请填写出生年份。";
                    isValid = false;
                }
                if (!birthMonthInput.value) {
                    errorMessage.textContent += "请填写出生月份。";
                    isValid = false;
                }
                if (!birthDayInput.value) {
                    errorMessage.textContent += "请填写出生日期。";
                    isValid = false;
                }
                if (!birthTimeInput.value) {
                    errorMessage.textContent += "请选择出生时间。";
                    isValid = false;
                }
                if (!Array.from(genderRadios).some(radio => radio.checked)) {
                    errorMessage.textContent += "请选择性别。";
                    isValid = false;
                }
                if (!provinceSelect.value) {
                    errorMessage.textContent += "请选择出生省份。";
                    isValid = false;
                }
                if (!citySelect.value) {
                    errorMessage.textContent += "请选择出生城市。";
                    isValid = false;
                }

                if (!isValid) {
                    errorMessage.style.display = 'block';
                }
                return isValid;
            }

            const stems = ["甲", "乙", "丙", "丁", "戊", "己", "庚", "辛", "壬", "癸"];
            const branches = ["子", "丑", "寅", "卯", "辰", "巳", "午", "未", "申", "酉", "戌", "亥"];

            function getStem(n) {
                return stems[n % 10];
            }

            function getBranch(n) {
                return branches[n % 12];
            }

            function calculateYearPillar(year) {
                let stemIndex = (year - 4) % 10;
                let branchIndex = (year - 4) % 12;
                return getStem(stemIndex) + getBranch(branchIndex);
            }

            function calculateMonthPillar(year, month) {
                let yearStem = (year - 4) % 10;
                let stemIndex = (yearStem % 5) * 2 + month - 1;
                if (stemIndex < 0) stemIndex += 10;
                let branchIndex = (month + 1) % 12;
                if (branchIndex < 0) branchIndex += 12;
                return getStem(stemIndex) + getBranch(branchIndex);
            }

            function calculateDayPillar(year, month, day) {
                const base = new Date(1900, 0, 1);
                const target = new Date(year, month - 1, day);
                const diffDays = Math.floor((target - base) / (1000 * 60 * 60 * 24));
                let stemIndex = (diffDays + 4) % 10;
                let branchIndex = (diffDays + 10) % 12;
                return getStem(stemIndex) + getBranch(branchIndex);
            }

            function calculateHourPillar(year, month, day, hour, longitude) {
                const beijingLongitude = 116.4;
                const timeDiff = Math.round((longitude - beijingLongitude) * 4 / 60);
                let adjustedHour = hour + timeDiff;
                if (adjustedHour >= 24) {
                    adjustedHour -= 24;
                } else if (adjustedHour < 0) {
                    adjustedHour += 24;
                }
                const daypillar = calculateDayPillar(year, month, day);
                const daystem = daypillar[0];
                let branchIndex = Math.floor(adjustedHour / 2) % 12;
                if (branchIndex < 0) branchIndex += 12;
                let stemIndex = 0;
                if (["甲", "己"].includes(daystem)) stemIndex = 0;
                if (["乙", "庚"].includes(daystem)) stemIndex = 2;
                if (["丙", "辛"].includes(daystem)) stemIndex = 4;
                if (["丁", "壬"].includes(daystem)) stemIndex = 6;
                if (["戊", "癸"].includes(daystem)) stemIndex = 8;
                stemIndex = (stemIndex + branchIndex) % 10;
                return getStem(stemIndex) + getBranch(branchIndex);
            }

            function calculateDayun(year, month, day, hour, gender) {
                const solarTerms = [
                    [3, 5],
                    [4, 4],
                    [5, 5],
                    [6, 5],
                    [7, 7],
                    [8, 7],
                    [9, 7],
                    [10, 8],
                    [11, 7],
                    [12, 7],
                    [1, 5],
                    [2, 4]
                ];
                let direction = ((gender === '男' && ["甲", "丙", "戊", "庚", "壬"].includes(calculateYearPillar(year)[0])) ||
                    (gender === '女' && ["乙", "丁", "己", "辛", "癸"].includes(calculateYearPillar(year)[0]))) ? 1 : -1;

                let nextTermMonth = month % 12;
                let nextTermYear = year;
                if (direction === 1 && nextTermMonth === 11) nextTermYear++;
                if (direction === -1 && nextTermMonth === 0) nextTermYear--;
                let nextTermDay = solarTerms[nextTermMonth][0];
                let nextTermHour = solarTerms[nextTermMonth][1];

                let birthDate = new Date(year, month - 1, day, hour, 0, 0);
                let termDate = new Date(nextTermYear, nextTermMonth, nextTermDay, nextTermHour, 0, 0);

                let diff = termDate.getTime() - birthDate.getTime();
                if (direction === -1) diff = birthDate.getTime() - termDate.getTime();

                let days = Math.floor(diff / (1000 * 60 * 60 * 24));
                let dayunStartYears = Math.floor(days / 3);
                let dayunStartYear = year + direction * dayunStartYears;
                let dayunStartMonth = month;

                const dayun = [];
                let monthPillar = calculateMonthPillar(year, month);
                let monthStemIndex = stems.indexOf(monthPillar[0]);
                let monthBranchIndex = branches.indexOf(monthPillar[1]);

                for (let i = 0; i < 10; i++) {
                    monthStemIndex = (monthStemIndex + direction + 10) % 10;
                    monthBranchIndex = (monthBranchIndex + direction + 12) % 12;
                    dayun.push(stems[monthStemIndex] + branches[monthBranchIndex]);
                }
                return {
                    startYear: dayunStartYear,
                    dayun
                };
            }

            const tenGods = {
                "甲": {
                    "甲": "比肩",
                    "乙": "劫财",
                    "丙": "食神",
                    "丁": "伤官",
                    "戊": "偏财",
                    "己": "正财",
                    "庚": "七杀",
                    "辛": "正官",
                    "壬": "偏印",
                    "癸": "正印"
                },
                "乙": {
                    "甲": "劫财",
                    "乙": "比肩",
                    "丙": "伤官",
                    "丁": "食神",
                    "戊": "正财",
                    "己": "偏财",
                    "庚": "正官",
                    "辛": "七杀",
                    "壬": "正印",
                    "癸": "偏印"
                },
                "丙": {
                    "甲": "偏印",
                    "乙": "正印",
                    "丙": "比肩",
                    "丁": "劫财",
                    "戊": "食神",
                    "己": "伤官",
                    "庚": "偏财",
                    "辛": "正财",
                    "壬": "七杀",
                    "癸": "正官"
                },
                "丁": {
                    "甲": "正印",
                    "乙": "偏印",
                    "丙": "劫财",
                    "丁": "比肩",
                    "戊": "伤官",
                    "己": "食神",
                    "庚": "正财",
                    "辛": "偏财",
                    "壬": "正官",
                    "癸": "七杀"
                },
                "戊": {
                    "甲": "七杀",
                    "乙": "正官",
                    "丙": "偏印",
                    "丁": "正印",
                    "戊": "比肩",
                    "己": "劫财",
                    "庚": "食神",
                    "辛": "伤官",
                    "壬": "偏财",
                    "癸": "正财"
                },
                "己": {
                    "甲": "正官",
                    "乙": "七杀",
                    "丙": "正印",
                    "丁": "偏印",
                    "戊": "劫财",
                    "己": "比肩",
                    "庚": "伤官",
                    "辛": "食神",
                    "壬": "正财",
                    "癸": "偏财"
                },
                "庚": {
                    "甲": "偏财",
                    "乙": "正财",
                    "丙": "七杀",
                    "丁": "正官",
                    "戊": "偏印",
                    "己": "正印",
                    "庚": "比肩",
                    "辛": "劫财",
                    "壬": "食神",
                    "癸": "伤官"
                },
                "辛": {
                    "甲": "正财",
                    "乙": "偏财",
                    "丙": "正官",
                    "丁": "七杀",
                    "戊": "正印",
                    "己": "偏印",
                    "庚": "劫财",
                    "辛": "比肩",
                    "壬": "伤官",
                    "癸": "食神"
                },
                "壬": {
                    "甲": "食神",
                    "乙": "伤官",
                    "丙": "偏财",
                    "丁": "正财",
                    "戊": "七杀",
                    "己": "正官",
                    "庚": "偏印",
                    "辛": "正印",
                    "壬": "比肩",
                    "癸": "劫财"
                },
                "癸": {
                    "甲": "伤官",
                    "乙": "食神",
                    "丙": "正财",
                    "丁": "偏财",
                    "戊": "正官",
                    "己": "七杀",
                    "庚": "正印",
                    "辛": "偏印",
                    "壬": "劫财",
                    "癸": "比肩"
                }
            };

            function calculateTenGod(dayStem, otherStem) {
                return tenGods[dayStem][otherStem];
            }

            function generateBaziPrompt(yearPillar, monthPillar, dayPillar, hourPillar, gender, birthProvince, birthCity, birthDistrict, bigLuck, birthYear) {
                const dayStem = dayPillar[0];
                const yearTenGod = calculateTenGod(dayStem, yearPillar[0]);
                const monthTenGod = calculateTenGod(dayStem, monthPillar[0]);
                const hourTenGod = calculateTenGod(dayStem, hourPillar[0]);

                let prompt = "";
                prompt += `你是一位对中国传统八字命理学有着深刻理解和丰富经验的专家。你精通《滴天髓》、《子平真诠》、《穷通宝鉴》等经典著作，擅长运用五行生克、十神意象、格局喜忌等理论，对人生命运进行分析和解读。\n\n`;
                prompt += `现在你将面对一个八字命例，请你运用你的专业知识和经验，对该命例进行全面、深入的分析，并给出有价值的建议。请你务必逐步思考、推理，并清晰地展示你的思考过程。\n\n`;

                prompt += `求测者的基本信息如下：\n`;
                prompt += `性别：${gender}\n`;
                prompt += `出生地区：${birthProvince} ${birthCity} ${birthDistrict ? birthDistrict : ""}\n`;
                prompt += `出生年份：${birthYear}年\n\n`;

                prompt += `其八字命盘如下：\n`;
                prompt += `年柱：${yearPillar}（${yearTenGod}）\n`;
                prompt += `月柱：${monthPillar}（${monthTenGod}）\n`;
                prompt += `日柱：${dayPillar}（日元）\n`;
                prompt += `时柱：${hourPillar}（${hourTenGod}）\n\n`;

                prompt += `大运信息：从${bigLuck.startYear}年起运，运程顺序为：${bigLuck.dayun.join('、')}\n\n`;

                prompt += `请你从以下几个方面入手，展开你的分析：\n\n`;

                prompt += `1.整体审视命局：首先，请你对整个八字命盘进行审视，从五行、阴阳、十神、格局等多个角度入手，对命局的整体特点进行概括性的描述。例如，五行是否均衡？阴阳是否协调？是否存在某种特殊的格局？日元得令、得地、得助吗？\n\n`;

                prompt += `2.分析日元强弱：日元代表命主自身，其强弱直接关系到命主的运势。请你结合月令、地支、天干等因素，综合判断日元的强弱，并说明判断的依据。如果日元偏强，喜什么？忌什么？如果日元偏弱，又该如何取用神？\n\n`;

                prompt += `3.剖析性格特征：性格决定命运。请你结合八字命盘，分析命主的性格特点、优缺点，以及可能的发展方向。例如，是积极进取还是保守稳重？是善于交际还是喜欢独处？是理性思维还是感性思维？这些性格特点对命主的人生有何影响？\n\n`;

                prompt += `4.推断事业发展：事业是人生价值的重要体现。请你结合八字命盘，分析命主的事业运势、适合的职业、发展方向等。例如，适合从事稳定的工作还是具有挑战性的工作？适合自己创业还是在企业中发展？在事业发展过程中需要注意哪些问题？\n\n`;

                prompt += `5.预测财富运势：财富是人生幸福的重要保障。请你结合八字命盘，分析命主的财富状况、财运走势、理财建议等。例如，是正财运旺盛还是偏财运旺盛？适合从事哪些行业的投资？在理财方面需要注意哪些问题？\n\n`;

                prompt += `6.研判婚姻情感：婚姻是人生重要的组成部分。请你结合八字命盘，分析命主的婚姻运势、情感状况、婚恋建议等。例如，是早婚好还是晚婚好？适合找什么样的伴侣？在婚姻中需要注意哪些问题？\n\n`;

                prompt += `7.关注健康状况：健康是幸福人生的基石。请你结合八字命盘，分析命主的健康状况、可能存在的健康隐患、养生建议等。例如，五行失衡可能导致哪些疾病？需要注意哪些方面的保健？\n\n`;

                prompt += `8.洞察六亲关系：六亲是与命主关系最为密切的人。请你结合八字命盘，分析命主与父母、配偶、子女等六亲的关系，以及六亲对命主的影响。例如，与父母的关系如何？配偶对自己有帮助吗？子女是否孝顺？\n\n`;

                prompt += `9.把握大运流年：大运和流年是影响命主运势的重要因素。请你结合大运和流年，分析命主在不同人生阶段的运势变化，为命主提供人生规划建议。例如，哪些年份是机遇期？哪些年份是挑战期？应该如何把握机遇、应对挑战？\n\n`;

                prompt += `在分析过程中，请你充分发挥你的聪明才智，运用你所掌握的命理学知识，结合实际情况，对命例进行深入的剖析和解读，并给出有价值的建议。\n\n`;
                prompt += `请记住，你的目标是帮助求测者更好地了解自己，把握命运，创造幸福的人生。\n\n`;
                prompt += `请开始你的分析吧！`;

                return prompt;
            }

            window.copyPrompt = function() {
                const promptText = outputDiv.textContent.replace('复制', '').trim();
                navigator.clipboard.writeText(promptText)
                    .then(() => {
                        alert('Prompt 已复制到剪贴板！');
                    })
                    .catch(err => {
                        console.error('复制失败:', err);
                        alert('复制失败，请手动复制。');
                    });
            };

            generateBtn.addEventListener('click', function() {
                if (validateForm()) {
                    const year = parseInt(birthYearInput.value);
                    const month = parseInt(birthMonthInput.value);
                    const day = parseInt(birthDayInput.value);
                    const hour = birthTimeInput.value.split(':')[0]; 
                    const gender = document.querySelector('input[name="gender"]:checked').value;
                    const birthProvince = provinceSelect.value;
                    const birthCity = citySelect.value;
                    const birthDistrict = districtInput.value;

                    const longitude = locationData[birthProvince][birthCity].longitude

                    const yearPillar = calculateYearPillar(year);
                    const monthPillar = calculateMonthPillar(year, month);
                    const dayPillar = calculateDayPillar(year, month, day);
                    const hourPillar = calculateHourPillar(year, month, day, hour, longitude);

                    const bigLuck = calculateDayun(year, month, day, hour, gender);

                    const prompt = generateBaziPrompt(yearPillar, monthPillar, dayPillar, hourPillar, gender, birthProvince, birthCity, birthDistrict, bigLuck, year);

                    outputDiv.textContent = prompt;
                    outputDiv.innerHTML = `<button class="copy-btn" onclick="copyPrompt()">复制</button>` + `<br>` + prompt;
                }
            });
            populateProvinces();

            provinceSelect.addEventListener('change', function() {
                const selectedProvince = this.value;
                populateCities(selectedProvince);
            });
        });
    </script>
</body>

</html>